// Copyright 2025 Google LLC.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

#ifndef PRIVACY_PROOFS_ZK_LIB_CIRCUITS_ANONCRED_PTRCRED_EXAMPLES_H_
#define PRIVACY_PROOFS_ZK_LIB_CIRCUITS_ANONCRED_PTRCRED_EXAMPLES_H_

#include <cstddef>
#include <cstdint>

#include "../../algebra/static_string.h"

namespace proofs {

// This structure holds all the data needed to test a pointer-credential.
// The data is pre-computed.
struct PtrCredTest {
  StaticString pkx, pky; /* public key of the issuer */
  StaticString sigr, sigs, sigtr, sigts;
  uint8_t transcript[32];
  size_t transcript_size;
  uint8_t *now;
  size_t ptrcred_size;
  uint8_t ptrcred[200];
};

// A sample pointer credential test case.
// It contains one attribute "age" with value "19".
// Generated with cryptographically valid P-256 signatures.
static const struct PtrCredTest ptrcred_tests[] = {
    {
        // Issuer public key
        StaticString("0xa4ec7e10953709aec1fe7891be4cf7eacfada26fadc51ee2c4e4569ca0533ea3"),
        StaticString("0xea41ee8719eea71631cc48d0f67ebae424b4c0fcffa4878ad979b85867c8172c"),
        // Signature over the credential
        StaticString("0x1bc8fa7d068ccf4566ea26ab4bcb98796d89000ce1293dbd1adb802b78a932e7"),
        StaticString("0x5189e9a7b374970cfc2fe0b31b7325f4143bb3d1613587caad848708610e9c66"),
        // Signature over the transcript (for device key)
        StaticString("0x54f19e50486e4dcbfd20f68f2ea88aafe4c6791fb9a152bb74c184804554b0db"),
        StaticString("0x08ed1e843e792d9e021547a47f08784178aeafa1ff46a04b0b35cb2352b92a27"),
        // Transcript
        {0x74, 0x65, 0x73, 0x74, 0x5f, 0x74, 0x72, 0x61, 0x6e, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x5f,
         0x66, 0x6f, 0x72, 0x5f, 0x64, 0x65, 0x76, 0x69, 0x63, 0x65, 0x5f, 0x6b, 0x65, 0x79, 0x21, 0x21},
        32,
        // "now" date
        (uint8_t *)"20241005",
        // Credential size
        170,
        // Credential data
        {
            0x01, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x61, 0x67, 0x65, 0x3a, 0x22, 0x31,
            0x39, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x32, 0x30, 0x32, 0x34, 0x31, 0x30, 0x30, 0x31, 0x32, 0x30, 0x32, 0x35,
            0x31, 0x30, 0x30, 0x31, 0xb9, 0xff, 0xea, 0xbe, 0x53, 0x88, 0xc3, 0xa2, 0x92, 0x6b, 0xa2, 0xde,
            0xfd, 0x8f, 0xd5, 0x10, 0x01, 0xdb, 0x79, 0x1f, 0x94, 0xc3, 0x96, 0x91, 0xd3, 0x02, 0x68, 0x0d,
            0xe2, 0x3e, 0x10, 0xde, 0x47, 0x2e, 0x49, 0x95, 0xba, 0xc1, 0x73, 0x24, 0xe8, 0x8f, 0x1e, 0xf6,
            0x28, 0xb9, 0xe0, 0x7f, 0xfc, 0x41, 0x53, 0x05, 0x04, 0x02, 0xd2, 0x81, 0xe0, 0x17, 0x14, 0xd8,
            0x66, 0x8e, 0xde, 0xa7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        }
    },
};

}  // namespace proofs

#endif  // PRIVACY_PROOFS_ZK_LIB_CIRCUITS_ANONCRED_PTRCRED_EXAMPLES_H_
